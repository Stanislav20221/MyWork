# -*- coding: utf-8 -*-
"""Академия ДПО "Нейро-продажник ч.2 | УИИ.ipynb"

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1mmwGCuurAzn5n_aSOKmADBhws4pwqRF4

# Готовим окружение
Устанавливаем пакеты.
Подключаем библиотеки.
"""

!pip install openai langchain langchain-community faiss-cpu langchain-openai tiktoken==0.7.0 >/dev/null

"""![image.png](data:image/png;base64,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)"""

#@title Определим класс для подсветки вывода разных моделей разными цветами
# https://en.wikipedia.org/wiki/ANSI_escape_code#Colors
class bcolors:
    HEADER = '\033[95m'
    OKBLUE = '\033[94m'
    OKCYAN = '\033[96m'
    OKGREEN = '\033[92m'
    GREEN = '\033[32m'
    RED = '\033[31m'
    BGGREEN = "\033[102m"
    BGYELLOW = "\033[103m"
    BGCYAN = "\033[106m"
    BGMAGENTA = "\033[105m"
    WARNING = '\033[93m'
    FAIL = '\033[91m'
    ENDC = '\033[0m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'

#@title Грузим библиотеки
import os
import re
import requests
#import getpass

import openai
import tiktoken

from langchain.docstore.document import Document
from langchain.text_splitter import MarkdownHeaderTextSplitter, RecursiveCharacterTextSplitter

from langchain_openai import OpenAIEmbeddings
from langchain_community.vectorstores import FAISS

from oauth2client.service_account import ServiceAccountCredentials

import json
import copy
import string

import textwrap
import textwrap as tw
import time
from datetime import datetime
from google.colab import userdata

#@title Инициируем ключи OpenAI через секрет
key = userdata.get('OPENAI_API_KEY')
os.environ["OPENAI_API_KEY"] = key

#@title Задаем константы
gpt_4o = 'gpt-4o'
gpt_4o_mini = 'gpt-4o-mini'
MODEL = gpt_4o_mini

num_chunks = 5
chunk_size = 1000
chunk_overlap = 0
temp = 0.1
verbose = 1
knowledge_db_url = 'https://docs.google.com/document/d/1mnGfGzmb6VnqNY9PzxuMYYDGewpJuEvqXY3rIRcUY0k/edit?tab=t.0'

#@title Объявляем переменные
history_chat = []
history_user = []
history_manager = []

needs_extractor = []
benefits_extractor = []
objection_detector = []
resolved_objection_detector = []
tariff_detector = []

main_answer = ''
summarized_dialog = ''

# @title Определяем функции python

# Функция форматирует строку по длинне для корректного вывода длинных строк
def wrap(s, max_width=150):
    wrapper = tw.TextWrapper(width=max_width, tabsize=4, replace_whitespace=False, drop_whitespace=True)
    return '\n'.join([wrapper.fill(l) for l in s.splitlines()])

"""# Модели GPT

## get_topicphrase_questions -  ключи из последних сообщений

эта генерация запускается после каждого нового вопроса пользователя, для выделения ключей в его сообщении, также выделяем ключи из последнего ответа
менеджера, далее через корректора ключей создадим общий логический контекст общения (к накопленному списку ключей добавим новые и скорректируем логику)
"""

#@title Параметры
name_todo_base = 'Экстрактор ключевых слов'
model_todo_base = MODEL
temperature_todo_base = 0
verbose_base = 0

system_topicphrase_extractor = '''
Ты - эксперт по образовательным услугам в академии дополнительного профессионального образования (Академии ДПО).
topic phrase - это ключевое слово, ключевое словосочетание или ключевая фраза в тексте, отражающее смысл текста в контексте покупки-продажи
курсов обучения искусственному интеллекту и программированию.
Ты знаешь, что термины такие как: наименования курсов  - это всегда topic phrase.
Ты никогда не включаешь в topic phrase имена людей.
Твоя задача выделить в Тексте ключевые topic phrase и добавить их в список.
Этот список будет использоваться для более эффективного поиска данных в базе знаний Академии ДПО. Оцениваться будут четкость и сжатость списка.
'''

instructions_topicphrase_extractor = '''
Проанализируй Текст и в своем ответе напиши кратко список самых лучших topic phrase в виде строки с разделителями (запятая).
'''

#@title Функция
def get_topicphrase_questions(name, _user, _manager, system, instruction, temp=0.0, verbose=verbose_base, model=MODEL):
    #  в том, что история клиента не пустая мы уверены, проверим, что есть история менеджера
    join_user = '\n'.join(_user)
    if history_manager:
      text = f'Текст: {join_user}\n\n{history_manager[-1]}'
    else:
      text = f'Текст: {join_user}'
    messages = [  {"role": "system", "content": system},
                  {"role": "user", "content": f'''{instruction}
                                    \n\nТекст: {text}
                                    \n\nОтвет: '''}
                ]
    completion = openai.chat.completions.create(
        model=model,
        messages=messages,
        temperature=temp,  # Используем более низкую температуру для более определенной суммаризации
    )
    answer = completion.choices[0].message.content
    if verbose:
      print(f'{bcolors.GREEN}{bcolors.BOLD}Ответ {wrap(name)}:{bcolors.ENDC}\n',
            f'{bcolors.BGYELLOW}Ключевые слова для Базы знаний:{bcolors.ENDC}\n {wrap(answer)}\n=========\n')
    return completion

"""## get_hello - выделение приветствия в первом сообщении клиента

Далее принудительно из ответов менеджера по продажам будем удалять приветствие, а в первом ответе менеджера отзеркалим приветствие клиента. Если клиент не поздоровался (или модель не опознала приветствие), добавим формально-нейтральное Здравствуйте
"""

#@title Параменты и функция
def get_hello(model_gen, topic, temp=temp, verbose=verbose):
  system = '''
  Приветствие - это выражение приветствия или приветственное сообщение,
  которое отправляется или произносится в начале общения с кем-либо.
  Приветствие может быть формальным или неформальным, зависеть от культуры и контекста.
  Оно служит для демонстрации вежливости, дружелюбия и желания установить контакт с собеседником.
  Приветствия могут быть разными в различных языках и культурах, от простого 'привет' или 'здравствуйте'
  до более формальных или традиционных выражений.
  Твоя задача выявить в Тексте клиента Приветствие.
  В свой ответ включи только найденное Приветствие.
  Если в тексте клиента нет Приветствия, тогда напиши: 'None'.
  '''
  user = f'Текст клиента: {topic}'
  messages = [{"role": "system", "content": system},{"role": "user", "content": user}]
  completion = openai.chat.completions.create(model=model_gen, messages=messages, temperature=temp)

  return completion

"""## summarize_dialog - суммаризация диалога

запускается перед работой диспетчера-маршрутизатора для формирования Хронологии предыдущих сообщений диалога. Всех специалистов будем просить строить свои ответы логичными относительно этой хронологии
"""

#@title Параметры и функция
def summarize_dialog(dialog, _history, temp=0.1, verbose=0, model=MODEL):
    i = 2 if len(_history) > 1 else 1  # берем 2 последних сообщения для саммаризации (предыд ответ менеджера и новый вопрос клиента)
    last_statements = ' '.join(_history[-i:])
    messages = [
        {"role": "system", "content": '''
                  Ты супер корректор, умеешь выделять в диалогах все самое важное.
                  Ты знаешь, что при саммаризации нельзя исключать из диалога специальные термины и названия курсов,
                  программ и тарифов.
                  Твоя задача сделать полное саммари на основании Истории предыдущих сообщений диалога и Последних сообщений.
                                         '''},
        {"role": "user", "content": f'''Суммаризируй Диалог, ничего не придумывай от себя. Если клиент представился, сохрани информацию об имени.
                                        Если клиент указал свой номер телефона или адрес электронной почты, обязательно отрази эту информацию в саммари.
                                        Если с клиентом есть договоренность о назначенном дне и времени созвона с менеджером, также отрази это в саммаризации.
                                      \n\nИстория предыдущих сообщений диалога: {dialog}.
                                      \n\nПоследние сообщения: {last_statements}
                                      \n\nОтвет: '''
        }
    ]
    completion = openai.chat.completions.create(
        model=model,
        messages=messages,
        temperature=temp,  # Используем более низкую температуру для более определенной суммаризации
    )
    answer = completion.choices[0].message.content
    if verbose:
      print(f'{bcolors.BGYELLOW}Саммари диалога:{bcolors.ENDC}\n', wrap(answer))
    return completion

"""## extract_entity_from_user_question - выделяет сущности из последнего сообщения клиента/менеджера

Искомые сущности: Возражения, Потребности, Преимущества, Отработка возражений, Тарифы и Цены

### Параметры
"""

#@title 1. Выделение в последнем сообщении клиента озвученных им потребностей
name_needs_extractor = 'Спец по потребностям'
model_needs_extractor = MODEL
temperature_needs_extractor = 0.2
verbose_needs_extractor = 0
system_prompt_needs_extractor = '''
Ты лучший специалист отдела продаж. Ты продаешь курсы Академии Дополнительного Профессионального образования.
Ты знаешь, что Потребность - это то, что клиент хочет или что ему нравится,
и что повлияет на приобретение им курсов обучения.
Ты очень хорошо умеешь выявлять в вопросе клиента его потребности.
Ты всегда очень строго следуешь порядку отчета.
'''
instructions_needs_extractor = '''
Давай действовать последовательно:
Проанализируй Вопрос клиента, выяви высказанные в нем явные потребности клиента (если они есть) и напиши их.
Ничего не придумывай от себя, если потребностей не выявлено, то напиши "-".
Порядок отчета: в своем ответе предоставь только список потребностей (или  "-") в виде строки с разделителями (запятые).
'''

#@title 2. Выделение в последнем сообщении менеджера названных им преимуществ
name_benefits_extractor = 'Спец по озвученным преимуществам'
model_benefits_extractor = MODEL
temperature_benefits_extractor = 0.2
verbose_benefits_extractor = 0
system_prompt_benefits_extractor='''
Ты лучший специалист по контролю качества отдела продаж и отлично умеешь находить в ответе менеджера
названные менеджером преимущества обучения в Академии Дополнительного Профессионального образования (сокр Академии ДПО).
У тебя для анализа есть Предыдущий ответ менеджера отдела продаж.
Ты всегда очень строго следуешь порядку отчета.
'''
instructions_benefits_extractor = '''
Давай действовать последовательно:
Проанализируй Предыдущий ответ Менеджера отдела продаж, найди в нем названные преимущества (если они есть) и напиши их;
Ничего не придумывай от себя, если преимущества не найдены, то напиши  "-".
Порядок отчета: в своем ответе предоставь только список преимуществ (или  "-") в виде строки с разделителями (запятые).
'''

#@title 3. Выделение в последнем сообщении клиента озвученных им возражений
name_objection_detector = 'Спец по возражениям'
model_objection_detector = MODEL
temperature_objection_detector = 0.2
verbose_objection_detector = 0
system_prompt_objection_detector = '''
Ты - лучший специалист отдела продаж, специализирующийся на продаже курсов обучения в Академии Дополнительного Профессионального образования.
Ты знаешь, что открытое возражение  - это явное заявление со стороны клиента о том, что его не устраивает и
что может быть преградой для приобретения курсов обучения, а просьбы клинета не являются возражениями.
Твоя задача - тщательно выявлять открытые возражения в Вопросе клиента.
Ты всегда строго следуешь порядку отчета.
'''
instructions_objection_detector = '''
Давай действовать последовательно:
Проанализируй Вопрос клиента и выдели открытые возражения, которые он высказывает (если они есть).
Примеры возражений могут включать в себя: "дорого", "мне не хватит знаний/опыта",
"мне не хватит времени на учебу", "слышал плохие отзывы", "наполнение", "все только обещают" и т.п.
В своем ответе укажи все выделенные открытые возражения клиента, соблюдая ту же последовательность, в какой они были
высказаны в его вопросе. Ничего не придумывай от себя: если возражений  не найдено, то в своем ответе напиши "-".
Порядок отчета: в свой ответ включи только список выделенных открытых возражений клиента (или  "-") в виде строки с разделителями (запятые).
'''

#@title 4. Выделение в последнем сообщении менеджера отработки возражений клиента
name_resolved_objection_detector = 'Спец по отработанным возражениям'
model_resolved_objection_detector = MODEL
temperature_resolved_objection_detector = 0.2
verbose_resolved_objection_detector = 0

system_prompt_resolved_objection_detector = '''
Ты лучший специалист по контролю качества отдела продаж и отлично умеешь выявлять как Менеджер отдела продаж отработал возражения клиента.
У тебя для анализа есть Предыдущий ответ Менеджера отдела продаж.
Твоя задача - тщательно выявлять отработал ли Менеджера отдела продаж возражения в своем ответе клиенту.
Ты всегда очень строго следуешь порядку отчета.
'''
instructions_resolved_objection_detector = '''
Давай действовать последовательно:
Проанализируй Предыдущий ответ Менеджера отдела продаж и найди в нем отработки возражений (если они есть) и напиши их.
Ничего не придумывай от себя: если отработки возражений  не найдено, то напиши "-".
Порядок отчета: в своем ответе предоставь только список отработок возражений (или "-") в виде строки с разделителями (запятые).
'''

#@title 5. Выделение в последнем сообщении менеджера названных им тарифов и цен
name_tariff_detector = 'Спец по тарифам'
model_tariff_detector = MODEL
temperature_tariff_detector = 0.1
verbose_tariff_detector = 0
system_prompt_tariff_detector = '''
Ты - аналитик по тарифам, ты прекрасно умеешь находить точное упоминание о тарифе в тексте.
У тебя есть закрытый Перечень тарифов: ["базовый тариф", "продвинутый тариф", "основной тариф", "расширенный тариф", "новый тариф", "фреймворки", "ChatGPT"].
У тебя для анализа есть Предыдущий ответ менеджера отдела продаж.
Ты всегда очень строго следуешь порядку отчета.
'''
instructions_tariff_detector = '''
Давай действовать последовательно:
Проанализируй Предыдущий ответ менеджера отдела продаж, и найди в нем тарифы из Переченя тарифов и напиши их;
если в ответе менеджера содержится упоминание о ценах, добавь их тоже в список.
Ничего не придумывай от себя: если Предыдущий ответ менеджера отдела продаж не содержит упоминаний о тарифах или ценах,то напиши "-".
Порядок отчета: в своем ответе предоставь только список найденных тарифов и цен (или "-") в виде строки с разделителями (запятые) без объяснений.
'''

"""### Функция выявления сущностей"""

def extract_entity_from_statement(name, system, instructions, question, history,temp=0, verbose=0, model=MODEL):
    if verbose: print('\n==================\n')
    if verbose: print(f'{bcolors.OKBLUE}{bcolors.BOLD}Вопрос клиента: {wrap(question)}{bcolors.ENDC}')
    if name not in ['Спец по потребностям', 'Спец по возражениям'] and len(history):  # эти спецы анализируют только вопрос пользователя
      history_content = history[-1]   # берем только один последний ответ Менеджера в истории
    else:
      history_content = 'сообщений нет'
    if verbose: print(f'{bcolors.BGCYAN}Предыдущий ответ Менеджера отдела продаж:{bcolors.ENDC}\n==================\n',
                         history_content)
    messages = [
        {"role": "system", "content": system},
        {"role": "user", "content": f"{instructions}\n\nВопрос клиента:{question}\n\nПредыдущий ответ Менеджера отдела продаж:\n{history_content}\n\nОтвет: "}
    ]
    completion = openai.chat.completions.create(
        model=model,
        messages=messages,
        temperature=temp
    )
    answer = completion.choices[0].message.content

    if verbose: print('\n==================\n')
    if verbose: print(f'{completion.usage.total_tokens} total tokens used (question-answer).')
    if verbose: print('\n==================\n')
    if verbose:
      print(f'{bcolors.GREEN}{bcolors.BOLD}Ответ {name}:{bcolors.ENDC}\n',
            f'{bcolors.GREEN}{wrap(answer)}{bcolors.ENDC}')
    if (name == 'Спец_по_выявлению_потребностей'):
        print("Выявлены потребности ")
    return completion

"""## spez_user_question - узкий специалист для генерации ответа

вызываются диспетчером-маршрутизатором готовят свою специализированную часть для того, чтобы старший менеджер но основе этих материалов сформировал проактивный ответ клиенту.

В распоряжении узких специалистов: База знания, контекст - ключи диалога, Хронология предыдущих сообщений диалога, точное саммари (отчет по выявленным и отработанным ранее сущностям)

### Параметры
"""

#@title 1. 'Обработчик_возражений'
name_spez2 = 'Обработчик_возражений'
model_spez2 = MODEL
temperature_spez2 = 0.1
verbose_spez2 = 0
system_prompt_spez2 = '''Вы лучший специалист по отработке возражений клиента. Вы работаете в Академии Дополнительного Профессионального образования (Академии ДПО), которая продает курсы подготовки и переподготовки по различным специальностям (менеджмент, бухгалтерское дело, педагогика и т.д.)."
Вы знаете, что отработка возражения - это процесс убеждения с помощью аргументов,
точных фактов и психологических приемов, которые помогают завуалированно донести до клиента мысль, что курсы ему нужны.
Вы знаете, что отработка возражений не имеет ничего общего с давлением: продавец не манипулирует, а показывает как удовлетворить потребности клинета с помощью продукта.
У Вас есть Точное саммари с отчетом о уже выявленных и уже отработанных возражениях клиента.
Вы всегда последовательно, шаг за шагом и убедительно отрабатываете возражения клиента.
При отработке возражения вы всегда следуете Хронологии предыдущих сообщений диалога чтобы сделать Ваш ответ логичным этой Хронологии.
Вы всегда очень строго следуете порядку отчета.
'''
instructions_spez2 = '''
Пожалуйста, проанализируйте запрос клиента и напишите убедительную и качественную отработку возражения клиента.
Отработку пишите строго на основании информации из Базы знаний, ничего не придумывайте от себя: если подходящей информации в Базе знаний нет,
напишите, что вопрос не связан с АДО.
Порядок отчета: в свой ответ выведите только отработку возражения.
'''

#@title 2. 'Спец_по_презентациям'
name_spez3 = 'Спец_по_презентациям'
model_spez3 = MODEL
temperature_spez3 = 0
verbose_spez3 = 0
system_prompt_spez3 = '''Вы - лучший специалист по презентации продукта и Академии Дополнительного Профессионального образования (Академии ДПО),
занимающейся продажей обучения. Ваш стиль общения деловой и очень краткий.
Ваша цель: сделать убедительную и качественную презентацию по запросу клиента (запрос может быть о курсах/программах обучения, стоимости, об Академии ДПО).
Ваши презентации всегда основаны на Вопросе клиента, его потребностях и желаниях, Вы всегда следуете логике Хронологии предыдущих сообщений диалога.
Вам запрещено повторять в своем ответе то, о чем уже говорилось в Хронологии предыдущих сообщений диалога.
Вы никогда не используете шаблонный скриптовый вариант презентации, всегда делаете её в неформальной форме.
Вы всегда строго следуете требованиям к порядку отчета.
'''

instructions_spez3 = '''
Давайте действовать по шагам:
#Шаг1: Проанализируйте Хронологию предыдущих сообщений диалога, чтобы выявить общую логику и последовательность общения менеджера по продажам и клиента, а также чтобы НЕ повторяться в своей презентации.
#Шаг2: Проанализируйте Вопрос клиента и Точное саммари чтобы выбрать контекст для презентации.
#Шаг3: Учитывая логику Шага1 и контекст Шага2, сделайте убедительную и качественную презентацию, не повторяйте сказанное в Хронологии предыдущих сообщений диалога.
Презентацию нужно делать на основании информации из Базы знаний, ничего не придумывайте от себя: если подходящей информации в Базе знаний нет,
напишите, что вопрос не связан с Академией ДПО.
Порядок отчета: в свой ответ включите только презентацию из Шага3.
'''

#@title 3. 'Zoom_Пуш'
name_spez4 = 'Zoom_Пуш'
model_spez4 = MODEL
temperature_spez4 = 0.2
verbose_spez4 = 0

system_prompt_spez4 = '''
Вы лучший эксперт по последовательности этапов, которые нужно пройти, чтобы записать клиента на встречу в Zoom с экспертом Академии Дополнительного Профессионального образования (Академии ДПО).
Запись на встречу в Zoom с экспертом состоит из нескольких строго последовательных этапов,
Ваша обязанность сообщать секретарю, к какому этапу записи он должен перейти в переговорах с клиентом при записи клиента на встречу в Zoom.
Вы строго следите за соблюдением последовательности этапов, описанной в Инструкции.
Вы всегда строго следуете логике Хронологии предыдущих сообщений диалога и Инструкции.
# Инструкция о последовательности этапов процесса записи на встречу с экспертом в Zoom:
##Этап1: клиент готов обсуждать детали приобретения курса/программы обучения или клиент просит записать его на встречу с экспертом;
##Этап2: менеджер по продажам предложил встречу с экспертом + клиент согласился на встречу, но конкретный день и время встречи еще не обсуждали;
##Этап3: клиент и менеджер договорились о конкретном дне и времени встречи с экспертом, клиент выбрал удобное для себя время из предложенных менеджером интервалов;
##Этап4: клиент указал свой номер телефона и e-mail.
Вам запрещено менять последовательность этапов записи на встречу (Вы всегда последовательно переходите от первого этапа ко второму, от второго к третьему, от третьего к четвертому).
Вы всегда строго следуете порядку отчета.
'''
instructions_spez4 = '''
Давайте действовать последовательно:
#Шаг1 Проанализируйте Хронологию предыдущих сообщений диалога и Вопрос клиента чтобы определить, на каком этапе последовательности записи на встречу экспертом находится клиент;
#Шаг2 На основании Вашего анализа напишите свой ответ:
##Шаг2.1 если вы считаете что отправлять клиента на встречу рано то напишите: 'не выявлено';
##Шаг2.2 если клиент готов к встрече, но в Хронологии предыдущих сообщений диалога не найдены пройденные этапы процесса записи на встречу с экспертом то напишите: Этап1;
##Шаг2.3 если по Хронологии предыдущих сообщений диалога Вы смогли определить на каком этапе находится процесс записи то в своем ответе напишите этот Этап, например: Этап2.
Последовательность и описание этапов должны строго соответствовать Инструкции.
Порядок отчета: в свой ответ напишите только результат #Шага2
'''

#@title 4. 'Спец_по_выявлению_потребностей'
name_spez5 = 'Спец_по_выявлению_потребностей'
model_spez5 = MODEL
temperature_spez5 = 0.4
verbose_spez5 = 0
system_prompt_spez5 = '''
Вы лучший менеджер по продажам с навыками NLP.
Вы понимаете какие потребности клиента надо выявить, чтобы полностью понять желания и боли клиента,
которые можно удовлетворить при помощи обучения в Академии Дополнительного Профессионального Обучения.
Вы знаете, что важно выявить есть ли у клиента такие потребности: в трудоустройстве, в росте дохода,
в возможности работать удаленно, развиваться в сферах предоставленных в рамках курсов Академии ДПО, сменить деятельность, в карьерном росте, во фрилансе,
в улучшении текущей позиции в компании, в развитии своего проекта (если он есть), в получении прибыли от своего
проекта (если он есть), в увекательном хобби, в личностном развитии и другие.
Вы понимаете, что нужно аккуратно и ненавязчиво выявить несколько разных потребностей и составляете свой ответ с этой целью.
Ваша задача: сформулировать вопросы клиенту, которые помогут качественно выявить его потребности.
Вы всегда очень строго следуете порядку отчета.
'''
instructions_spez5 = '''
Давайте действовать по шагам:
#Шаг1: Проанализируйте Точное саммари 'Раздел 1 Выявлены Потребности', найдите в нем уже выявленные потребности (ничего не придумывайте от себя);
#Шаг2: Предположите три другие потребности, которых нет среди выявленных потребностей в Шаг1;
#Шаг3: Учитывая, что выявление потребностей должно провоцировать дальнейший диалог и заинтересовывать клиента,
для каждой потребности из Шаг2 напишите по одному вопросу для качественного выявления этой потребности. Ничего, кроме вопросов не пишите и не объясняйте.
Порядок отчета: В свой ответ включите только список вопросов Шаг3, ничего кроме списка вопросов выводить не нужно.
'''

history = []
a = extract_entity_from_statement(name_spez5, system_prompt_spez5, instructions_spez5, "Я хочу изучить Питон, чтобы зарабатывать на этои", history,temp=0, verbose=0, model=MODEL)
a

#@title 5. 'Спец_по_завершению'
name_spez6 = 'Спец_по_завершению'
model_spez6 = MODEL
temperature_spez6 = 0.4
verbose_spez6 = 0
system_prompt_spez6 = '''
Ты Василий, менеджер по продажам Академии Дополнительного Профессионального Обучения.
Ты неплохо разбираешься в специальностях, по направлениям, которые предлагает Академия Дополнительного Профессионального Обучения.
Вы общаетесь с клиентом о покупке курса.
Ты завершаешь диалог и прощаешься с клиентом.
Твоя задача: отвечать когда диалог подошел к завершению - когда клиент прекращает задавать новые вопросы или не написал в своём сообщении ничего кроме таких фраз как “спасибо”, “понятно” или прощальных фраз, или задал вопрос не по теме.
Ты знаешь, что прощальные фразы - это фразы или выражения которые используются для окончания общения или разговора.
Прощальные фразы часто служат для передачи понимания, согласия, благодарности или желания прощания (например пока, до свидания, до скорой встречи, всего наилучшего, до новых встреч).
Прощальные фразы имеют различные тон и уровень формальности, и выбор конкретной фразы зависит от контекста.
Ты всегда четко следуешь Хронологии предыдущих сообщений диалога, чтобы сделать свой ответ логичным этой Хронологии.
Тебе запрещено задавать клиенту вопросы. Тебе запрещено отвечать на запросы клиента.
Твоя задача написать клиенту сообщение завершающее диалог, подтвердить договоренности о встрече (если были) и попрощаться с клиентом.
'''
instructions_spez6 = '''Проанализируй Вопрос клиента и Хронологию предыдущих сообщений диалога: если клиент задал вопрос, который не связан со специальностями предоставленными
 для обучения в Академии Дополнительного Профессионального Обучения,  в своем ответе тебе нужно написать, что ты не можешь отвечать
на вопросы, не связанные с обучением в Академии ДПО, в остальных случаях напиши клиенту сообщение, завершающее диалог, подтверди договоренности о встрече и попрощайся с клиентом..
'''

"""### Функция"""

def spez_user_question(name, system, instructions, question, summary_history, summary_exact, base_topicphrase, search_index, temp=0, verbose=0, k=num_chunks, model=MODEL):
    if name in ["Zoom_Пуш", "Спец_по_завершению"]:
      docs_content = ''
    else:
      knowledge_base = search_index.similarity_search(base_topicphrase, k=k)
      docs_content = re.sub(r'\n{2}', ' ', '\n '.join([f'\n==================\n' + doc.page_content + '\n' for doc in knowledge_base]))
    messages = [
        {"role": "system", "content": system},
        {"role": "user", "content": f'''{instructions}

         Вопрос клиента:{question}

         Хронология предыдущих сообщений диалога: {summary_history}

         Точное саммари: {summary_exact}

         База Знаний: {docs_content}'''}
    ]
    if verbose: print('\n==================\n')
    if verbose: print(f'{bcolors.BGCYAN}Вопрос клиента:{bcolors.ENDC}', wrap(question))
    if verbose: print('Саммари диалога:\n==================\n',
                         wrap(summary_history))
    if verbose: print(f'{bcolors.BGYELLOW}Саммари точное:{bcolors.ENDC}\n==================\n',
                         wrap(summary_exact))
    if verbose: print(f'{bcolors.BGGREEN}База знаний:{bcolors.ENDC}\n==================\n', wrap(docs_content))

    completion = openai.chat.completions.create(
        model=model,
        messages=messages,
        temperature=temp
    )
    answer = completion.choices[0].message.content
    try:
      answer = answer.split(': ')[1]+ ' '
    except:
      answer = answer
    answer = answer.lstrip('#3')
    if verbose: print(f'\n==================')
    if verbose: print(f'{completion.usage.total_tokens} total tokens used (question-answer).')
    if verbose: print('\n==================\n')
    if verbose: print(f'{bcolors.RED}{bcolors.BOLD}Ответ {wrap(name)}:{bcolors.ENDC}\n',
                      f'{bcolors.RED}{wrap(answer)}{bcolors.ENDC}')
    return completion

"""### Конфигурация"""

spez_config ={
    'Обработчик_возражений': {
        'name':name_spez2,
        'system':system_prompt_spez2,
        'instructions':instructions_spez2,
        'k': num_chunks,
        'temp':temperature_spez2,
        'verbose': verbose_spez2,
        'model':model_spez2,
        },
    'Спец_по_презентациям': {
        'name':name_spez3,
        'system':system_prompt_spez3,
        'instructions':instructions_spez3,
        'k': num_chunks,
        'temp':temperature_spez3,
        'verbose': verbose_spez3,
        'model':model_spez3,
        },
    'Zoom_Пуш': {
        'name':name_spez4,
        'system':system_prompt_spez4,
        'instructions':instructions_spez4,
        'k': num_chunks,
        'temp':temperature_spez4,
        'verbose': verbose_spez4,
        'model':model_spez4,
        },
    'Спец_по_выявлению_потребностей': {
        'name':name_spez5,
        'system':system_prompt_spez5,
        'instructions':instructions_spez5,
        'k': num_chunks,
        'temp':temperature_spez5,
        'verbose': verbose_spez5,
        'model':model_spez5,
        },
    'Спец_по_завершению': {
        'name':name_spez6,
        'system':system_prompt_spez6,
        'instructions':instructions_spez6,
        'k': num_chunks,
        'temp':temperature_spez6,
        'verbose': verbose_spez6,
        'model':model_spez6,
        }

}

"""## user_question_router - Диспетчер-маршрутизатор

модель определяет по контексту, Хронологии предыдущих сообщений диалога и точному саммари каких узких специалистов нужно привлечь для подготовки материалов для проактивного ответа Старшего менеджера
"""

#@title Параметры
name_router = 'Диспетчер-маршрутизатор'
model_router = MODEL
temperature_router = 0
verbose_router = 0

# если уже выявлено 4 потребности, то больше потребности вывлять не нужно.
# это можно сделать в промпте, но он перегружен. Поэтому ограничим вызов спеца по выявлению программно:
system_prompt_router ='''
Ты идеально справляешься со своей задачей: ты определяешь к каким специалистам нужно обратиться, чтобы корректно сформировать ответ клиенту.
Ты знаешь, что можно обратиться только к специалистам из Перечня: '''
instructions_router ='''
Пожалуйста, будем действовать по шагам:
#Шаг1: проанализируйте Вопрос клиента и Хронологию предыдущих сообщений диалога чтобы быть в контексте;
#Шаг2: проанализируйте Точное саммари - оно содержит кратко уже выявленные потребности, отработанные возражения и презентованные тарифы;
#Шаг3: опираясь на анализ Шаг1 и Шаг2 напиши список специалистов для ответа клиенту.
Отвечай, пожалуйста, точно, и ничего не придумывай от себя.
Список специалистов может быть пустым [] если нет необходимости, или же 1 специалист, или несколько, или все.
Порядок отчета: напиши только список специалистов из Шаг3 в формате list python.
'''

#@title Функция
def user_question_router(name, system, instructions, question, summary_history, summary_exact, temp=0, verbose=0, model=MODEL, needs_lst=[]):
    if verbose: print('\n==================\n')
    if verbose: print(f'{bcolors.BGCYAN}Вопрос клиента:{bcolors.ENDC}', wrap(question))
    if verbose: print('Саммари диалога:\n==================\n',
                         wrap(summary_history))
    if verbose: print(f'{bcolors.BGYELLOW}Саммари точное:{bcolors.ENDC}\n==================\n',
                         wrap(summary_exact))


    if needs_extractor and len(needs_extractor) > 5:
      system +=''' ["Обработчик_возражений", "Спец_по_презентациям", "Zoom_Пуш", “Спец_по_завершению”]. Ты знаешь, за что отвечает каждый специалист:
  #1 Обработчик_возражений:  этот специалист участвует в ответе клиенту если:
  #1.1 клиент высказал возражение или сомнение;
  #1.2 клиент чем-то недоволен или не все устраивает в продукте;
  #2 Спец_по_презентациям: этот специалист участвует в ответе клиенту если клиент выразил заинтересованность курсами, программами
  и нужно презентовать какой-либо курс представленный в списке для обучения Академии ДПО или какую-то его часть, а также презентовать компанию Академия
  Дополнительного Профессионального Обучения (сокр Академия ДПО), если при этом в Хронологии предыдущих сообщений диалога он это уже презентовал, то повторно презентовать запрещено;
  #3 Zoom_Пуш: этот специалист участвует в ответе клиенту когда:
  #3.1 клиент говорит что курс или программа обучения ему подходит - чтобы позвать клиента на созвон или встречу с экспертом;
  #3.2 клиент выражает готовность к покупке курса или программы обучения - чтобы позвать клиента на созвон или встречу с экспертом для оформления покупки;
  #3.3 клиент обсуждает день и время созвона или встречи с экспертом в Zoom чтобы договориться о встрече;
  #3.4 клиент предоставляет свои контактные данные для отправки приглашения на созвон или встречу в Zoom;
  #4 Спец_по_завершению: этот специалист участвует в ответе клиенту в самом конце диалога, его задача отвечать когда пользователь дает понять,
  что завершает диалог и больше не намерен ничего спрашивать, например: "спасибо","все понтяно","хорошо", "ладно" и прочие утвердительные
  выражения логически завершающие общение.'''
    else:
      system +=''' ["Спец_по_выявлению_потребностей", "Обработчик_возражений", "Спец_по_презентациям", "Zoom_Пуш",  “Спец_по_завершению”]. Вот описание специалистов:
  #1 Спец_по_выявлению_потребностей: этот специалист всегда участвует в ответе;
  #2 Обработчик_возражений:  этот специалист участвует в ответе клиенту если:
  #2.1 клиент высказал возражение или сомнение;
  #2.2 клиент чем-то недоволен или не все устраивает в продукте;
  #3 Спец_по_презентациям: этот специалист участвует в ответе клиенту если клиент выразил заинтересованность курсами, программами
  и нужно презентовать курс из предоставленного в программе обучения Академии Дополнительного Профессионального Обучения
   или какую-то его часть, а также презентовать компанию Академия Дополнительного Профессионального Обучения (сокр Академия ДПО),
   если при этом в Хронологии предыдущих сообщений диалога он это уже презентовал, то повторно презентовать запрещено;
  #4 Zoom_Пуш: этот специалист участвует в ответе клиенту когда:
  #4.1 клиент говорит что курс или программа обучения ему подходит - чтобы позвать клиента на созвон или встречу с экспертом;
  #4.2 клиент выражает готовность к покупке курса или программы обучения - чтобы позвать клиента на созвон или встречу с экспертом для оформления покупки;
  #4.3 клиент обсуждает день и время созвона или встречи с экспертом в Zoom чтобы договориться о встрече;
  #4.4 клиент предоставляет свои контактные данные для отправки приглашения на созвон или встречу в Zoom;
  #5 Спец_по_завершению: этот специалист участвует в ответе клиенту в самом конце диалога, его задача отвечать когда пользователь дает понять,
  что завершает диалог и больше не намерен ничего спрашивать, например: "спасибо","все понтяно","хорошо", "ладно" и прочие утвердительные
  выражения логически завершающие общение.'''
    system +='''
  Твоя задача: определить по сообщению клиента, на основании твоих знаний, Точного саммари и Хронологии предыдущих сообщений диалога каких специалистов из Перечня надо выбрать,
  чтобы они участвовали в ответе клиенту. Ты всегда очень строго следуешь требованиям к порядку отчета.'''


    messages = [
        {"role": "system", "content": system},
        {"role": "user", "content": f'''{instructions}
                                      \n\nВопрос клиента:{question}
                                      \n\nХронология предыдущих сообщений диалога: {summary_history}
                                      \n\nСаммари точное: {summary_exact}
                                      \n\nОтвет: '''}
    ]
    completion = openai.chat.completions.create(
        model=model,
        messages=messages,
        temperature=temp
    )
    answer = completion.choices[0].message.content
    if verbose: print(f'\n==================')
    if verbose: print(f'{completion.usage.total_tokens} total tokens used (question-answer).')
    if verbose: print('\n==================\n')
    if verbose: print(f'{bcolors.RED}{bcolors.BOLD}Ответ {wrap(name)}:{bcolors.ENDC}\n',
                      f'{bcolors.RED}{wrap(answer)}{bcolors.ENDC}')
    if verbose: print(f'{bcolors.RED}{wrap(answer)}{bcolors.ENDC}')
    #print(f'{bcolors.RED}{answer}{bcolors.ENDC}')

    return completion

"""## Стиль вопросов и ответов от заказчика"""

answer_question_etolon = {
    'Выдается ли документ государственного образца?':'''
                                                      Академия дополнительного профессионального образования (Академия ДПО) выдает слушателям документы установленного образца.
                                                      Удостоверение о повышении квалификации: Выдается лицам, прошедшим программы повышения квалификации объемом менее 250 часов. Это удостоверение подтверждает повышение уровня профессиональной подготовки специалиста.
                                                      Диплом о профессиональной переподготовке: Предоставляется выпускникам программ профессиональной переподготовки объемом свыше 250 часов. Такой диплом позволяет заниматься деятельностью в новой сфере профессии.
                                                      Эти документы соответствуют требованиям Федерального закона № 273-ФЗ "Об образовании в Российской Федерации", но они не являются аналогичными дипломам вузов или образовательных организаций среднего профессионального образования.
                                                      Документы академии ДПО имеют установленный государством формат оформления, подписи должностных лиц и печати организации, но считаются документом негосударственного образовательного учреждения.
                                                     ''',

     'Есть ли вступительные испытания?':'''
                                        Вступительных испытаний в Академии дополнительного профессионального образования нет. Поступление проходит следующим образом:
                                        Заявка и регистрация: Для поступления достаточно подать заявку онлайн или лично, предоставив необходимые документы (обычно копию диплома о высшем или среднем профессиональном образовании).
                                        Проверка квалификационных требований: Поскольку обучение в Академии ДПО направлено на специалистов, имеющих базовую подготовку, учебные заведения проверяют наличие соответствующего образования и опыта работы (при необходимости).
                                     ''',

    'Какая форма обучения предлагается?':'''
                                      — Полностью удаленное обучение через электронную платформу.— Удобно для занятых людей, позволяет учиться в удобное время и месте.
                                        ''',
    'Существуют ли дополнительные расходы помимо платы за обучение?': 'Нет, никаких расходов помимо платы за обучения.'

}

"""## senior_answer - генерация старшим менеджером проактивного ответа на основании данных узких специалистов (вставить стилизацию ответов в промпт)"""

#@title Параметры
name_senior = 'Старший менеджер по продажам'
model_senior = MODEL
temperature_senior = 0.2
verbose_senior = 0
num_fragments_base_senior = num_chunks
system_prompt_senior = '''
#1 Кто вы такой: Вы человек, мужчина. Вы лучший старший менеджер отдела продаж. Вы работаете в Академии Дополнительного Профессионального Обучения (сокр Академия ДПО),
который продает курсы обучения по специальностям Архитектура и дизайн,  Бухгалтерское дело, Государственное и муниципальное управление, Государственные закупки,  Здравоохранение и медицина,
Землеустройство и кадастр, Инженерное изыскание, Информационные технологии,  Кадровое делопроизводство, Лаборатории,  Маркшейдерское дело,  Менеджмент, Метрология и стандартизация,
Нефтегазовое дело,  Новости, Охрана труда, Оценочная деятельность,  Педагогика, Подъемные сооружения и лифты,  Проектирование, Реставрация,  Спорт и фитнес,  Строительство,
Промышленная безопасность, Профессиональная переподготовка,  Техническое обслуживание медицинской техники,  Транспортная безопасность,  Холодильное оборудование,  Экологическая безопасность,  Экономика и финанс
Электробезопасность, Энергетика, Юриспруденция, .
Вы неплохо разбираетесь в этих специальностях и в целом и очень хорошо знаете, какие курсы и программы обучения предоставляет Академия ДПО.
При формировании ответа всегда следуете логике Хронологии предыдущих сообщений диалога чтобы Ваш ответ клиенту был логичным и последовательным и
в первую очередь ориентируетесь на Ответы узких специалистов:
 '''

instructions_senior = f'''
Пожалуйста, давайте думать последовательно. Вам нужно решить эти задачи:
#1 задача: проанализируйте Ответы узких специалистов - это информация на которую Вы опираетесь при ответе;
#2 задача: проанализируйте Хронологию предыдущих сообщений диалога чтобы написать свой ответ последовательным и логичным этой хронологии;
#3 задача: проанализируйте Точное саммари, чтобы понять, какие  были высказаны потребности, возражения и какие возражения были уже отработаны в ходе диалога и не повторяться;
#4 задача:  опираясь на свой анализ в задачах 1-3 и следуя Инструкциям напишите логичный, краткий, последовательный ответ клиенту, имитируя ответ реального человека следуя порядку отчета:
в своем ответе не говорите клиенту о своих целях; всегда пишите текст в неформальной форме, не называйте клиента клиентом, если в Хронологии предыдущих сообщений диалога
есть информация об имени клиента, то добавьте имя клиента в свой ответ. Ответ должен быть по форме, структуре и содержанию схож с ответами в образце. Вот образец вопросов и ответов {answer_question_etolon}
При формировании своего ответа Вам запрещено повторять тезисы, которые уже были высказаны в Хронологии предыдущих сообщений диалога.
'''

#@title Функция
def senior_answer(name, system, instructions, question, output_spez,
                                   summary_history, base_topicphrase, search_index, summary_exact, temp=0,
                                   verbose=0, k=num_chunks, model=MODEL, spez_list = []):
    # дозаполним system по набору спецов
    if 'Спец_по_завершению'  in spez_list:
        system += "Спец_по_завершению."
    else:
        system += '''Обработчик_возражений, Спец_по_презентациям, Zoom_пуш, Спец_по_выявлению_потребностей.
#2 Ваша цель общения: в течение всего диалога выявить потребности клиента, закрыть все возражения клиента и в итоге назначить встречу клиента с экспертом для обсуждения деталей
приобретения курса в соответствии с выявленными потребностями.
Вы всегда строго следуете Инструкциям и порядку отчета.
#3 Инструкция как отвечать на вопрос клиента:
##3.1 При формировании своего ответа вы всегда следуете логике Хронологии предыдущих сообщений диалога и опираетесь на Ответы узких специалистов.
##3.2 Презентацию делайте только в том случае, если клиент попросит рассказать о курсе\обучении\академии или она закрывает какие-то потребности, презентуйте опираясь на ответ
 Спец_по_презентациям;
##3.3 Если у вас есть ответ Обработчик_возражений, то закройте возражения, опираясь на ответ Обработчик_возражений;
##3.4 Вы знаете, что Вам важно закрыть все возражения клиента;
##3.5 В ответе Вам категорически запрещено говорить что Вы выясняете потребности и цели клиента;
##3.6 Вам запрещено разговаривать на посторонние темы.
#4 Инструкция как отвечать на посторонние темы: если в Ответах узких специалистов написано, что вопрос не связан с Академией Дополнительного Профессионального образования, это значит, что нужно вежливо отказаться
отвечать на вопросы на посторонние темы и уточнить, есть ли у клиента вопросы касающиеся курсов, программ обучения в АДО или самой Академии.'''

    if 'Zoom_Пуш'  in spez_list:
        system += '''
#5 Инструкция как звать клиента на встречу с экспертом в Zoom:
##5.1 Проанализируйте ответ специалиста Zoom_Пуш: он должен сообщить Вам текущий этап процесса записи на встречу с экспертом (например, "Этап2").
##5.2 Если в ответе Zoom_Пуш нет текущего этапа, то пока назначать встречу с экспертом рано;
##5.3 Если в ответе Zoom_Пуш есть текущий этап, найдите в Таблице этапов Инструкцию, соответствующую текущему этапу и подготовте свой ответ строго в полном соответствии с этой
инструкцией.
Ничего не придумывайте от себя, строго следуйте инструкции текущего этапа:
###Таблица этапов:
|Этап| Инструкция|
|Этап1| Аргументируйте на основании потребностей клиента зачем ему нужно согласиться на Zoom встречу и задайте вопрос подтверждающий согласие клиента на участие во встрече;|
|Этап2| Предложите клиенту на выбор три конкретных варианта временных промежутков для встречи (например, "Завтра в 16:00, Завтра в 20:00, Послезавтра в 10:00" и тп)
и попросите клиента выбрать (из предложенных) подходящее;|
|Этап3| Запросите номер телефона и почту и аргументируйте что телефон нужен Вам чтобы отправить ссылку на встречу клиенту;|
|Этап4| Поблагодарите клиента за приятный диалог и напишите о том что встреча назначена на такой-то день и такое-то время|
Вы обязаны в точности следовать инструкции текущего этапа записи на встречу, ничего не исключайте из нее и не добавляйте от себя.'''
    system += '''
Вы всегда строго следуете порядку отчета'''

    # дозаполним instructions по набору спецов
    if 'Спец_по_завершению'  not in spez_list:
      if 'Спец_по_выявлению_потребностей' in spez_list:
        instructions += '''
#5 задача:  Опираясь на свой анализ выберите только один вопрос из ответа Спец_по_выявлению_потребностей, которого нет в Хронологии предыдущих сообщений диалога и он лучше всего подходит
логике Хронологии предыдущих сообщений диалога.'''
      else:
        instructions += '''
#5 задача: Опираясь на свой анализ задайте вопрос, который должен способствовать продолжению диалога, продолжая логику Хронологи предыдущих сообщений диалога.'''
      instructions += '''  Не объясняйте свой выбор и ничего не комментируйте, не поясняйте из ответа каких специалистов Вы формируете свой ответ.
Порядок отчета: В Вашем ответе должен быть только ответ клиенту (Задача 4) + только вопрос клиенту (Задача 5) (без пояснений и комментариев).'''
    else:
      instructions += '''
В свой ответ только включите ответ Спец_по_завершению.
Порядок отчета: В Вашем ответе должен быть только ответ клиенту.
'''
#    knowledge_base = search_index.similarity_search(base_topicphrase, k=2)
#    docs_content = re.sub(r'\n{2}', ' ', '\n '.join([f'\n=====\n' + doc.page_content + '\n' for doc in knowledge_base]))
    output_spez_content = "\n=====\n".join(output_spez)
    if verbose:
      print(f'{bcolors.BGGREEN}Ответы узких специалистов:{bcolors.ENDC}{wrap(output_spez_content)}\n')
    messages = [
        {"role": "system", "content": system},
        {"role": "user", "content": f'''{instructions}
                                    \nВопрос клиента: {question}
                                    \nХронология предыдущих сообщений диалога: {summary_history}
                                    \nСаммари точное: {summary_exact}
                                    \nОтветы узких специалистов: {output_spez_content}

                                    \nОтвет: '''}
    ]
#                                    \nДополнительная информация: {docs_content}
    completion = openai.chat.completions.create(
        model=model,
        messages=messages,
        temperature=temp
    )

  #   if verbose:
   #   print(f'{bcolors.OKBLUE}{bcolors.BOLD}Ответ {wrap(name)}:{bcolors.ENDC}\n',
      #      f'{bcolors.OKBLUE}{wrap(completion.choices[0].message.content)}{bcolors.ENDC}')

    return completion

"""## Стилист"""

#@title Параметры
name_stilist = 'Стилист'
model_stilist = MODEL
temperature_stilist = 0.2
verbose_stilist = 0
system_prompt_stilist = '''
Вы молодой человек, мужчина, общаетесь интересно для собеседника,
Вы любите Академию Дополнительного Профессионального образования (сокр АДО) и Вам очень нравятся специальности, по которым можно обучиться в АДО,
так же Вы отличный писатель. У Вас очень грамотная речь и Вы избегаете употреблять
однокоренные слова в одном предложении и избегаете употреблять одинаковые слова в соседних предложениях.
Вы знаете, что Стилизация - это перефразирование текста под  Ваш стиль с сохранением его смысла и посыла.
Ваш стиль является человеческим, кратким и убедительным, Вы не используете клише и шаблонные выражения а также обращения, такие как "Уважаемый...", "Клиент" и т.п.
Вы всегда соблюдаете 5 правил.
Ваша задача: стилизовать Исходный текст так, чтобы создавалось 100% имитация диалога с реальным человеком.
'''
instructions_stilist = '''
Давайте подумаем по шагам:
#Шаг1: проанализируйте Исходный текст;
#Шаг2: перефразируйте Исходный текст в Вашем стиле, соблюдая ВСЕ 5 правил на 100%:
#2.1 если в Исходном тексте есть обращения к клиенту “на ты”, то замените их все обращениями “на Вы”;
#2.2 если в Исходном тексте есть пожелания удачи и успехов, то исключите их из своего ответа;
#2.3 если в Исходном тексте есть закрытые вопросы, то их перефразируйте в открытые;
#2.4 Вам запрещено называть клиента "клиент"
#2.5 Вам запрещено подписываться "С уважением, Академия Дополнительного Профессионального образования (или похожим образом)
Порядок отчета: в свой ответ включите только стилизованный текст.
'''

#@title Функция
def stilizator_answer(name, system, instructions, answers_content, temp=0, verbose=0, model=MODEL):

    if verbose: print('==================')
    if verbose: print(f'{bcolors.BGCYAN}Текст для стилизации:{bcolors.ENDC}\n{wrap(answers_content)}')
    user_assist = f'''{instructions}\n\nИсходный текст: Кира, я рад, что ты заинтересовалась нашими курсами. Наши программы обучения позволят тебе погрузиться в мир искусственного интеллекта с самого начала обучения.
        Ты сможешь принять участие в реальных проектах уже с начала обучения, что поможет тебе получить ценный опыт и умения, необходимые для успешной карьеры в этой области.
        Какие области твоей жизни ты бы хотела улучшить с помощью обучения в области искусственного интеллекта?

        Ответ:
    '''
    user_assist2 = f'''{instructions}\n\nИсходный текст: У нас в АДО самая обширная база учебного контента по различным специальностям, включая 174 темы, что значительно
 превосходит количество учебных материалов у конкурентов. Какие возможности для трудоустройства в сфере менеджмента, бухгвлтерского дела, педагогики, психологии и т.д Вас
 интересуют?
        Ответ:
    '''

    messages = [

        {"role": "system", "content": system},
        {"role": "user", "content": user_assist},
        {"role": "assistant", "content": '''Кира, я рад, что Вы заинтересовались нашими курсами. Наши образовательные программы позволят Вам окунуться в мир искусственного интеллекта с самого начала. Участвуя в реальных проектах уже на старте обучения, Вы сможете получить ценный опыт и необходимые умения для успешной карьеры в этой области. Что именно Вы хотели бы улучшить в своей жизни, изучая искусственный интеллект?'''},
        {"role": "user", "content": user_assist2},
        {"role": "assistant", "content": '''У нас в УИИ самая обширная база учебного контента по искусственному интеллекту, включая 174 темы, что значительно
 превосходит количество учебных материалов у конкурентов, включая SkillBox. Может быть Вас интересуют возможности для трудоустройства в сфере искусственного интеллекта и программирования?'''},
        {"role": "user", "content": f'''{instructions}\n\nИсходный текст: {answers_content}\n\nОтвет: '''}
    ]

    completion = openai.chat.completions.create(
        model=model,
        messages=messages,
        temperature=temp
    )

    if verbose: print('\n==================')
    if verbose: print(f'{completion.usage.total_tokens} total tokens used (question-answer).')
    if verbose: print('==================')
    if verbose:
      print(f'{bcolors.BGMAGENTA}Ответ {wrap(name)}:{bcolors.ENDC}\n',
            f'{bcolors.HEADER}{wrap(completion.choices[0].message.content)}{bcolors.ENDC}')

    return completion

"""## Очистка от приветствия"""

#@title Параметры:
system_prompt_stilist1 = '''
Ты отличный редактор текстов и лучше всех умеешь находить в тексте приветствие (приветственную фразу).
Приветствие - это выражение приветствия или приветственное сообщение,
которое отправляется или произносится в начале общения с кем-либо.
Приветствие может быть формальным или неформальным, зависеть от культуры и контекста.
Оно служит для демонстрации вежливости, дружелюбия и желания установить контакт с собеседником.
Приветствия могут быть разными в различных языках и культурах, от простого 'привет' или 'здравствуйте'
до более формальных или традиционных выражений.
Твоя задача обработать Исходный текст следующим образом: проанализировать Исходный текст и если в нем есть приветствие, то удалить его.
В свой ответ включи обработанный текст без приветствия.
'''
instructions_prompt_stilist1 = ''

#@title Функция
def del_hello(name, system, instructions, answers_content, temp=0, verbose=0, model=MODEL):

    if verbose: print('==================')
    if verbose: print(f'{bcolors.BGCYAN}Текст для стилизации:{bcolors.ENDC}\n{wrap(answers_content)}')
    user_assist = '''\n\nИсходный текст: Добрый день, Кира, я готов рассказать Вам о курсе подробнее. Начнем с тарифов?\n\nОтвет:'''
    messages = [
        {"role": "system", "content": system},
        {"role": "user", "content": user_assist},
        {"role": "assistant", "content":'''Кира, я готов рассказать Вам о курсе подробнее. Начнем с тарифов?'''},
        {"role": "user", "content": f'''\n\nИсходный текст: {answers_content}\n\nОтвет: '''}
    ]
    completion = openai.chat.completions.create(
        model=model,
        messages=messages,
        temperature=temp
    )

    if verbose: print('\n==================')
    if verbose: print(f'{completion.usage.total_tokens} total tokens used (question-answer).')
    if verbose: print('==================')
    if verbose:
      print(f'{bcolors.BGMAGENTA}Ответ {name}:{bcolors.ENDC}\n',
            f'{bcolors.HEADER}{wrap(completion.choices[0].message.content)}{bcolors.ENDC}')

    return completion

"""# Функции Python"""

#@title Общие функции
# Функция загружает plane text из ГуглДока по URL-ссылке (url).
# ГуглДок должен быть открыт для чтения всем, у кого есть ссылка
def load_googledoc_by_url(url: str) -> str:
        match_ = re.search('/document/d/([a-zA-Z0-9-_]+)', url)
        if match_ is None:
            raise ValueError('Invalid Google Docs URL')
        doc_id = match_.group(1)
        response = requests.get(f'https://docs.google.com/document/d/{doc_id}/export?format=txt')
        response.raise_for_status()
        return response.text

# Функция подсчета токенов для модели эмбеддингов
def num_tokens_from_string(string: str, encoding_name: str) -> int:
    """Returns the number of tokens in a text string."""
    encoding = tiktoken.get_encoding(encoding_name)
    num_tokens = len(encoding.encode(string))
    return num_tokens

# функция подсчета токенов в сообщении модели
def num_tokens_from_messages(messages, model):
      """Returns the number of tokens used by a list of messages."""
      try:
          encoding = tiktoken.encoding_for_model(model)
      except KeyError:
          encoding = tiktoken.get_encoding("cl100k_base")
      if model in ["gpt-4o", "gpt-4o-mini"]:  # note: future models may deviate from this
          num_tokens = 0
          for message in messages:
              num_tokens += 4  # every message follows <im_start>{role/name}\n{content}<im_end>\n
              for key, value in message.items():
                  num_tokens += len(encoding.encode(value))
                  if key == "name":  # if there's a name, the role is omitted
                      num_tokens += -1  # role is always required and always 1 token
          num_tokens += 2  # every reply is primed with <im_start>assistant
          return num_tokens
      else:
          raise NotImplementedError(f"""num_tokens_from_messages() is not presently implemented for model {model}.
          See https://github.com/openai/openai-python/blob/main/chatml.md for information on how messages are converted to tokens.""")


# Функция разделения текста на чанки заданной длины (в токенах)
def split_text(text, max_count, chunk_overlap):

    # Функция для подсчета количества токенов во фрагменте для сплиттера RecursiveCharacterTextSplitter
    def num_tokens(fragment):
        return num_tokens_from_string(fragment, "cl100k_base")

    num_levels = 3  # Число уровней заголовков, которые будем разделять сплиттером MarkdownHeaderTextSplitter

    headers_to_split_on = [
    (f"{'#' * i}", f"H{i}") for i in range(1, num_levels + 1)
    ]
    # сначала разделим с помощью MarkdownHeaderTextSplitter
    markdown_splitter = MarkdownHeaderTextSplitter(headers_to_split_on=headers_to_split_on)
    fragments = markdown_splitter.split_text(text)


    # дальше будем делить делить каждый полученный чанк вторым сплиттером RecursiveCharacterTextSplitter
    # 1. для того, чтобы быть уверенным в размере полученного чанка
    # 2. база знаний размечена так, что заголовки не повторяются в тексте разделов, мы это исправим принудительно:

    splitter = RecursiveCharacterTextSplitter(chunk_size=max_count, chunk_overlap=0, length_function=num_tokens)

    source_chunks = []

    # Обработаем каждый фрагмент текста, полученный после MarkdownHeaderTextSplitter
    for fragment in fragments:
    # MarkdownHeaderTextSplitter сохранил иерархию заголовков в Метаданных - вытащим ее
      level = 0
      headers = ['','','','']
      for j in range(1, num_levels + 1):
        header_key = f'H{j}'
        if header_key in fragment.metadata: level, headers[j-1] = j, fragment.metadata[header_key]
      header_string = ' '.join([f"{'#' * i} {header}" for i, header in enumerate(headers[:level], start=1)])

    # каждый фрагмент будем разбивать на чанки с помощью RecursiveCharacterTextSplitter
    # допишем иерархию заголовков в конец чанка
    # унаследуем метаданные от первого сплиттера
    # добавим в метаданные размер чанка в токенах
      for i,chunk in enumerate(splitter.split_text(fragment.page_content)):
        mdata = fragment.metadata.copy()
        add_hierarchy = f'{header_string}: уровень {level} пункт {i+1}'
        new_chunk = ' '.join([chunk, f'\nРаздел: {add_hierarchy}'])
        mdata["len"] = num_tokens(new_chunk)
        doc = Document(page_content=new_chunk, metadata=mdata)
        source_chunks.append(doc)

    return source_chunks

# функция для очистки списка строк от повторений (для формирования более корректного точного саммари)
def list_cleaner(list_to_clean):
  filtered_list = [value.replace('"', '').strip() for value in list_to_clean if value.replace('"', '').strip() != '']
  text = ', '.join(filtered_list).replace('\n', ',').replace('-', ' ')
  phrases = text.split(',')
  return list(set(map(str.strip, text.split(','))))

# Запуск модели  суфлера при первом обращении клиента
def sufler(history_user):
  hello_completion = get_hello(MODEL,history_user[0],0.4,0)
  hello = hello_completion.choices[0].message.content
  try:
      hello_word = str(hello).split(': ')[1]+ ' '
  except:
      hello_word = str(hello)

  hello_word = hello_word.capitalize().rstrip(string.punctuation) + ', '

  if 'None' in hello_word: hello_word='Здравствуйте,'  # если пользователь не поздоровался, то мы поздороваемся нейтрально-формально

  return hello_word

# Функция удаления перехода на новую строку
def remove_newlines(text):
    cleaned_string = text.replace('\n', ' ')
    return cleaned_string

#фунция добавления переходов на новую строку для удобства чтения
# здесь в параметр text подается текст без переносов строки
# функция добавит переходы на новую строку при достижении max_len символов
def insert_newlines(text: str, max_len: int = 160) -> str:
      words = text.split()
      lines = []
      current_line = ""
      for word in words:
          if len(current_line + " " + word) > max_len:
              lines.append(current_line)
              current_line = ""
          current_line += f' {word}'
      lines.append(current_line)
      return "\n".join(lines)

#функция добавления переходов на новую строку для удобства чтения
# здесь в параметр text подается текст, содержащий переносы строки
# функция добавит переходы на новую строку при достижении max_len символов
def insert_newlines_n(text: str, max_len: int = 150) -> str:
    lines = text.splitlines()
    new_lines = []
    for line in lines:
        words = line.split()
        current_line = ""
        for word in words:
            if len(current_line + " " + word) > max_len:
                new_lines.append(current_line)
                current_line = ""
            current_line += f' {word}'
        new_lines.append(current_line)
    return "\n".join(new_lines)

#@title Ансамбль моделей для формирования ответа нейро-продажника

def get_seller_answer(history_user, history_manager, history_chat):
    output_router_list = []

    global needs_extractor
    global benefits_extractor
    global objection_detector
    global resolved_objection_detector
    global tariff_detector

    global summarized_dialog


    # 1. Выделим потребности из последнего сообщения клиента  и добавим в историю потребностей
    output_ne = extract_entity_from_statement(
                      name=name_needs_extractor,
                      system=system_prompt_needs_extractor,
                      instructions=instructions_needs_extractor,
                      question=history_user[-1],
                      history='',
                      temp=temperature_needs_extractor,
                      verbose=verbose_needs_extractor,
                      model=model_needs_extractor).choices[0].message.content
    try:
      output_needs_extractor = str(output_ne).split(':')[1]+ ''
    except:
      output_needs_extractor = str(output_ne)
    needs_extractor.append(output_needs_extractor)
    needs_extractor = list_cleaner(needs_extractor)

    # 2. Выделим названные менеджером преимущества, добавим в историю озвученных преимуществ
    output_be = extract_entity_from_statement(
                      name=name_benefits_extractor,
                      system=system_prompt_benefits_extractor,
                      instructions=instructions_benefits_extractor,
                      question='',
                      history=history_manager,
                      temp=temperature_benefits_extractor,
                      verbose=verbose_benefits_extractor,
                      model=model_benefits_extractor).choices[0].message.content
    try:
      output_benefits_extractor = str(output_be).split(':')[1]+ ''
    except:
      output_benefits_extractor = str(output_be)
    benefits_extractor.append(output_benefits_extractor)
    benefits_extractor = list_cleaner(benefits_extractor)

    #3. Выделим наличие возражений, добавим их в историю возражений
    output_obj = extract_entity_from_statement(
                      name=name_objection_detector,
                      system=system_prompt_objection_detector,
                      instructions=instructions_objection_detector,
                      question=history_user[-1],
                      history='',
                      temp=temperature_objection_detector,
                      verbose=verbose_objection_detector,
                      model=model_objection_detector).choices[0].message.content
    try:
        output_objection_detector = str(output_obj).split(':')[1]+ ''
    except:
        output_objection_detector = str(output_obj)
    objection_detector.append(output_objection_detector)
    objection_detector = list_cleaner(objection_detector)

    #4. Выделим отработанные менеджером возражения клиента, добавим их в историю отработанных возражений
    output_res = extract_entity_from_statement(
                      name=name_resolved_objection_detector,
                      system=system_prompt_resolved_objection_detector,
                      instructions=instructions_resolved_objection_detector,
                      question='',
                      history=history_manager,
                      temp=temperature_resolved_objection_detector,
                      verbose=verbose_resolved_objection_detector,
                      model=model_resolved_objection_detector).choices[0].message.content
    try:
        output_resolved_objection_detector = str(output_res).split(':')[1]+ ''
    except:
        output_resolved_objection_detector = str(output_res)
    resolved_objection_detector.append(output_resolved_objection_detector)
    resolved_objection_detector = list_cleaner(resolved_objection_detector)

    #5. Выделим названные менеджером тарифы и цены, добавим их в историю названных тарифов и цен
    output_tar = extract_entity_from_statement(
                      name=name_tariff_detector,
                      system=system_prompt_tariff_detector,
                      instructions=instructions_tariff_detector,
                      question='',
                      history=history_manager,
                      temp=temperature_tariff_detector,
                      verbose=verbose_tariff_detector,
                      model=model_tariff_detector).choices[0].message.content
    try:
        output_tariff_detector = str(output_tar).split(':')[1]+ ''
    except:
        output_tariff_detector = str(output_tar)
    tariff_detector.append(output_tariff_detector)
    tariff_detector = list_cleaner(tariff_detector)

    #6. Выделим ключи из последних сообщений клиента и менеджера (предыдущий вопрос+ответ)
    k = 2 if len(history_user)>1 else 1
    if history_manager and len(history_manager)>0:
      manager_list = history_manager[-1:]
    else:
      manager_list = []

    topicphrase_completion = get_topicphrase_questions(name=name_todo_base,
                                _user=history_user[-k:],
                                _manager = manager_list,
                                system=system_topicphrase_extractor,
                                instruction=instructions_topicphrase_extractor,
                                temp=temperature_todo_base,
                                verbose=verbose_base,
                                model=model_todo_base)
    topicphrase_answ = topicphrase_completion.choices[0].message.content

    # именно general_topic_phrase будем подавать в Langchain для similary search, преобразуем в строку-перечисление через запятую + добавляем текущий вопрос клиента
    general_topic_phrase = str(history_user[-1]+', ' + topicphrase_answ).replace('[','') .replace(']','').replace("'",'').replace("'",'')

    #7. Суммаризируем хронологию предыдущих сообщений диалога
    summarized_comp = summarize_dialog(summarized_dialog, history_chat, temp=0.1, verbose=verbose_router, model=MODEL)
    summarized_dialog = summarized_comp.choices[0].message.content

    #8. Создаем точное саммари с ключевыми моментами диалога
    tochnoe_summary = f'''
# 1. Выявлены Потребности: {', '.join(needs_extractor) if needs_extractor else 'потребностей не обнаружено'}
# 2. Расказанные Преимущества: {', '.join(benefits_extractor) if benefits_extractor else 'преимущества не были рассказаны'}
# 3. Возражения клиента: {', '.join(objection_detector) if objection_detector else 'возражений не обнаружено'}
# 4. Возражения клиента отработаны: {', '.join(resolved_objection_detector) if resolved_objection_detector else 'отработки не обнаружено'}
# 5. Конкретика - оговоренная конкретика - курсы, цены: {', '.join(tariff_detector) if tariff_detector else 'не обнаружено'}
'''
    #9. Запускаем Диспетчера
    output_router = user_question_router(name= name_router,
                                        system=system_prompt_router,
                                        instructions=instructions_router,
                                        question=history_user[-1],
                                        summary_history=summarized_dialog,
                                        summary_exact=tochnoe_summary,
                                        temp=temperature_router,
                                        verbose=verbose_router,
                                        model=model_router,
                                        needs_lst=needs_extractor).choices[0].message.content

    output_router = output_router.replace("```", '"').replace("python", '').replace("‘", '"').replace("'", '"').strip()

    #10. По списку спецов из ответа Диспетчера запускаем спецов:
    output_spez = []
    try:
        output_router_fixed = (str(output_router).split(':')[1]+ '').replace("‘", '"').replace("'", '"')
    except:
        output_router_fixed = str(output_router).replace("‘", '"').replace("'", '"')

    try:
      output_router_list = json.loads(output_router_fixed)
    except:
      output_router_list = ['Zoom_Пуш', 'Спец_по_презентациям']

    print(f'{bcolors.RED}{output_router_list}{bcolors.ENDC}')
    try:
      for key_param in output_router_list:
          param = spez_config[key_param] | {'question': history_user[-1],
                                      'summary_history': summarized_dialog,
                                      'summary_exact': tochnoe_summary,
                                      'base_topicphrase': general_topic_phrase,
                                      'search_index': vectordb}
          spez_answer = spez_user_question(**param).choices[0].message.content
          try:
            answer = spez_answer.split(': ')[1]+ ' '
          except:
            answer = spez_answer
          answer = answer.lstrip('#3')

          output_spez.append(f'{param["name"]}: {wrap(answer)}')

     # if verbose: print(f"\n{bcolors.BGMAGENTA}Ответы спецов:{bcolors.ENDC}\n", '\n\n=========\n'.join(output_spez))
    except:
      if verbose: print(f'{bcolors.BGYELLOW}Ответ диспетчера либо не вызывает спецов либо имеет неверный формат:{bcolors.ENDC} {wrap(output_router)}')


    #11. На основании предлоажения узких спецов запускаем страшего менеджера для подготовки комплексного ответа:
    output_senior = senior_answer(
                          name=name_senior,
                          system=system_prompt_senior,
                          instructions=instructions_senior,
                          question=history_user[-1],
                          output_spez=output_spez,
                          summary_history=summarized_dialog,
                          base_topicphrase=general_topic_phrase,
                          search_index=vectordb,
                          summary_exact=tochnoe_summary,
                          temp=temperature_senior,
                          verbose=verbose_senior,
                          k=num_fragments_base_senior,
                          model=model_senior,
                          spez_list=output_router_list).choices[0].message.content
    #if verbose: print(f"\n{bcolors.BGMAGENTA}senior: {bcolors.ENDC} {wrap(output_senior)}", )
    #12. Запускаем Стилиста:
    output_stilist = stilizator_answer(
                          name=name_stilist,
                          system=system_prompt_stilist,
                          instructions=instructions_stilist,
                          answers_content=output_senior,
                          temp=temperature_stilist,
                          verbose=verbose_stilist,
                         model=model_stilist).choices[0].message.content

    #13. контрольный выстрел по приветствиям:
    output_stilist_withouthello = del_hello(
                          name=name_stilist,
                          system=system_prompt_stilist1,
                          instructions=instructions_prompt_stilist1,
                          answers_content=output_stilist,
                          temp=temperature_stilist,
                          verbose=verbose_stilist,
                          model=model_stilist).choices[0].message.content

    return output_stilist_withouthello

"""# Функция ответа, если задает вопрос сотрудник компании"""

def answer_employee(system, user, db, question, temp=0, verbose=0, model=MODEL):
    results = db.similarity_search(question, k=5)
    retrieved_context = "\n\n".join([r.page_content if hasattr(r, "page_content") else str(r) for r in results])

    messages = [
        {"role": "system", "content": system},
        {"role": "user", "content": f'{user, retrieved_context} Вопрос клиента: {question}'},
    ]
    completion = openai.chat.completions.create(
        model=model,
        messages=messages,
        temperature=temp
    )


    return completion.choices[0].message.content.strip()

"""# Подгружаем Базу знаний

##Размер чанка большой, даже при разбиении дьвумя сплиттерами, поэтому дополнительно делим на батчи
"""

# @title Загружаем Базу Знаний, индексируем, сохраняем индексы
knowledge_db_txt = load_googledoc_by_url(knowledge_db_url)
# Разбиваем на чанки
docs = split_text(knowledge_db_txt, chunk_size, chunk_overlap)
from tqdm import tqdm

embeddings = OpenAIEmbeddings(model="text-embedding-3-small")

batch_size = 100  # или меньше, если чанки длинные
all_dbs = []

for i in tqdm(range(0, len(docs), batch_size)):
    batch = docs[i:i + batch_size]
    db = FAISS.from_documents(batch, embeddings)
    all_dbs.append(db)

# Объединяем в одну базу
db = all_dbs[0]
for db_v in all_dbs[1:]:
    db.merge_from(db_v)

db.save_local("UII_database_markdown")

# @title Загружаем индексы Базы Знаний
vectordb = FAISS.load_local('/content/UII_database_markdown', OpenAIEmbeddings(), allow_dangerous_deserialization = True)

print('Индексирование Базы Знаний завершено!')

"""## Функция для ответа на вопрос сотруднику компании"""

system_employee = 'Ты работаешь в Академии Дополниттельного профессионального образования, ты знаешь всю информацию об академии, об учебных программах и курсах, ты можешь ответить на любой вопрос, связанный с академией, ее программами и курсами'
user_employee = f'''
                Твоя задача - дать лаконичный ответ такому же сотруднику академии. Ты должен отвечать на вопрос так, как будто спрашивает тебя коллега - в меру понятно. Если вопрос требует детальных объяснений - включи их в ответ.
                Придерживайся стиля ответов, изложенных в примере. Пример вопросов и ответов: {answer_question_etolon} Отвечай на основании информации из документа. Не придумывай ничего от себя. Документ:
               '''

user = 'Что такое профессиональная переподготовка?'
a = answer_employee(system_employee, user_employee, db, user)
a

"""# Диалог"""

verbose = 1

user_type = "client"

def run_answer(user_type:str):
      #@title Запуск диалога
      history_chat = []
      history_user = []
      history_manager = []

      needs_extractor = []
      benefits_extractor = []
      objection_detector = []
      resolved_objection_detector = []
      tariff_detector = []

      main_answer = ''
      summarized_dialog = ''
      if (user_type == "client"):
            while True:
                client_question = input(f'{bcolors.BGCYAN}Вопрос клиента:{bcolors.ENDC}')

                start_time = time.time()  # Начало итерации - после ввода

                history_user.append(client_question)
                history_chat.append(f"Клиент: {client_question}")
                if len(history_user) == 1: hello_word = sufler(history_user)  # запомнили приветствие
                if client_question.lower() in ['stop', 'стоп']:
                    break
                without_hello = get_seller_answer(history_user, history_manager, history_chat)
                if len(history_chat) == 1 and 'None' not in hello_word:
                    main_answer = f'{hello_word} меня зовут Василий, я менеджер отдела продаж в Академиии Дополннительного профессионального образрвания (Академии ДПО). ' + without_hello
                else:
                    main_answer = without_hello

            #   print(f'{bcolors.BGGREEN}Василий:{bcolors.ENDC}\n {insert_newlines(remove_newlines(main_answer), 160)}')
                print(f'{bcolors.BGGREEN}Василий:{bcolors.ENDC} {wrap(remove_newlines(main_answer))}')

                history_chat.append(f"Менеджер: {without_hello}")
                history_manager.append(without_hello) # не будем Василия хранить в истории, чтобы не путать gpt лишними именами

                end_time = time.time()  # Конец итерации
                print(f"Время, затраченное на итерацию: {end_time - start_time:.2f} секунды")
                history_chat.append(f"Клиент: {client_question}")
                if len(history_user) == 1: hello_word = sufler(history_user)  # запомнили приветствие
                if client_question.lower() in ['stop', 'стоп']:
                    break
                without_hello = get_seller_answer(history_user, history_manager, history_chat)
                if len(history_chat) == 1 and 'None' not in hello_word:
                    main_answer = f'{hello_word} меня зовут Василий, я менеджер отдела продаж в Академии ДПО. ' + without_hello
                else:
                    main_answer = without_hello


            # Запуск сохранения
            from datetime import datetime
            text_file = f'dialog_{datetime.now().strftime("%d.%m.%Y_%H.%M.%S")}.txt'
      else:
            employee_question = input(f'{bcolors.BGCYAN}Вопрос сотрудника:{bcolors.ENDC} ')
            history_chat.append(f"Сотрудник: {employee_question}")
            answer = answer_employee(system_employee, user_employee, db, employee_question)
            history_chat.append(f"Менеджер: {answer}")
                        # Запуск сохранения
            from datetime import datetime
            text_file = f'dialog_{datetime.now().strftime("%d.%m.%Y_%H.%M.%S")}.txt'
            print(f'{bcolors.BGGREEN}Василий:{bcolors.ENDC} {wrap(remove_newlines(answer))}')

      with open(text_file, "w") as f:
          f.write(str('\n\n'.join(history_chat)))

history_chat = []
history_user = []
history_manager = []

needs_extractor = []
benefits_extractor = []
objection_detector = []
resolved_objection_detector = []
tariff_detector = []

run_answer(user_type)

user_type = "Сотрудник компании"
run_answer(user_type)

user_type = "Сотрудник компании"
run_answer(user_type)